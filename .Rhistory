aes(color = variable_col), size = 4) +
geom_point(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 10) +
scale_y_reverse(breaks = 100:1, sec.axis = dup_axis()) +
scale_x_continuous(breaks = seq(2001, 2020, 2), limits= c(1999.8, 2021.2),
expand = c(.05, .05), sec.axis = dup_axis()) +
geom_text(data = pdf5 %>% filter(year == "2001"),
aes(label = word, x = 2000.8, color = variable_col),
hjust = "right",
fontface = "bold",
size = 11) +
geom_text(data = pdf5 %>%  filter(year == "2020"),
aes(label = word, x = 2020.2, color = variable_col),
hjust = "left",
fontface = "bold",
size = 11) +
coord_cartesian(ylim = c(101,1)) +
scale_color_manual(values = cols) +
labs(title = "<b style='color:red;'>NCWSS</b> annual meeting
proceedinds text analysis from 2001 through 2020",
subtitle = "Figure shows the rank of top 100 words of 2001 (left)
and 2020 (right) <b style='color:red;'>NCWSS</b> annual meeting proceedings.
Common weed species names are highlighed \n to describe
their change across 20 years.",
y= "Rank",
caption = "Visualization: @maxwelco adapted from @JaredBraggins | Source: NCWSS")
#Export plot
ggsave("top_weeds.png", width = 40, height = 60, dpi=400, limitsize = FALSE, figure)
figure <- pdf5 %>%
ggplot(aes(x = year, y = rank, group = word)) +
geom_line(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 4) +
geom_point(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 10) +
geom_line(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 4) +
geom_point(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 10) +
scale_y_reverse(breaks = 100:1, sec.axis = dup_axis()) +
scale_x_continuous(breaks = seq(2001, 2020, 2), limits= c(1999.8, 2021.2),
expand = c(.05, .05), sec.axis = dup_axis()) +
geom_text(data = pdf5 %>% filter(year == "2001"),
aes(label = word, x = 2000.8, color = variable_col),
hjust = "right",
fontface = "bold",
size = 11) +
geom_text(data = pdf5 %>%  filter(year == "2020"),
aes(label = word, x = 2020.2, color = variable_col),
hjust = "left",
fontface = "bold",
size = 11) +
coord_cartesian(ylim = c(101,1)) +
scale_color_manual(values = cols) +
labs(title = "<b style='color:red;'>NCWSS</b> annual meeting
proceedinds text analysis from 2001 through 2020",
subtitle = "Figure shows the rank of top 100 words of 2001 (left)
and 2020 (right) <b style='color:red;'>NCWSS</b> annual meeting proceedings.
Common weed species names are highlighed \nto describe
their change across 20 years.",
y= "Rank",
caption = "Visualization: @maxwelco adapted from @JaredBraggins | Source: NCWSS")
#Export plot
ggsave("top_weeds.png", width = 40, height = 60, dpi=400, limitsize = FALSE, figure)
figure <- pdf5 %>%
ggplot(aes(x = year, y = rank, group = word)) +
geom_line(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 4) +
geom_point(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 10) +
geom_line(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 4) +
geom_point(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 10) +
scale_y_reverse(breaks = 100:1, sec.axis = dup_axis()) +
scale_x_continuous(breaks = seq(2001, 2020, 2), limits= c(1999.8, 2021.2),
expand = c(.05, .05), sec.axis = dup_axis()) +
geom_text(data = pdf5 %>% filter(year == "2001"),
aes(label = word, x = 2000.8, color = variable_col),
hjust = "right",
fontface = "bold",
size = 11) +
geom_text(data = pdf5 %>%  filter(year == "2020"),
aes(label = word, x = 2020.2, color = variable_col),
hjust = "left",
fontface = "bold",
size = 11) +
coord_cartesian(ylim = c(101,1)) +
scale_color_manual(values = cols) +
labs(title = "<b style='color:red;'>NCWSS</b> annual meeting
proceedinds text analysis from 2001 through 2020",
subtitle = "Figure shows the rank of top 100 words of 2001 (left)
and 2020 (right) <b style='color:red;'>NCWSS</b> annual meeting proceedings.
Common weed species names are highlighed \nto describe
their change across 20 years.",
y= "Rank",
caption = "Visualization: @maxwelco adapted from @JaredBraggins | Source: NCWSS")
#Export plot
ggsave("top_weeds.png", width = 40, height = 60, dpi=400, limitsize = FALSE, figure)
figure <- pdf5 %>%
ggplot(aes(x = year, y = rank, group = word)) +
geom_line(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 4) +
geom_point(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 10) +
geom_line(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 4) +
geom_point(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 10) +
scale_y_reverse(breaks = 100:1, sec.axis = dup_axis()) +
scale_x_continuous(breaks = seq(2001, 2020, 2), limits= c(1999.8, 2021.2),
expand = c(.05, .05), sec.axis = dup_axis()) +
geom_text(data = pdf5 %>% filter(year == "2001"),
aes(label = word, x = 2000.8, color = variable_col),
hjust = "right",
fontface = "bold",
size = 11) +
geom_text(data = pdf5 %>%  filter(year == "2020"),
aes(label = word, x = 2020.2, color = variable_col),
hjust = "left",
fontface = "bold",
size = 11) +
coord_cartesian(ylim = c(101,1)) +
scale_color_manual(values = cols) +
labs(title = "<b style='color:red;'>NCWSS</b> annual meeting
proceedinds text analysis from 2001 through 2020",
subtitle = "Figure shows the rank of top 100 words of 2001 (left)
and 2020 (right) <b style='color:red;'>NCWSS</b> annual meeting proceedings.
Common weed species names are highlighed \n to describe
their change across 20 years.",
y= "Rank",
caption = "Visualization: @maxwelco adapted from @JaredBraggins | Source: NCWSS")
#Export plot
ggsave("top_weeds.png", width = 40, height = 60, dpi=400, limitsize = FALSE, figure)
#Set theme
library(extrafont)
extrafont::loadfonts()
font_family <- 'Helvetica'
title_family <- ".New York"
background <- "#1D1D1D"
text_colour <- "white"
axis_colour <- "white"
plot_colour <- "black"
theme_style <- theme(text = element_text(family = font_family),
rect = element_rect(fill = background),
plot.background = element_rect(fill = background, color = NA),
plot.title = element_markdown(family = title_family,
face = 'bold', size = 80, colour = text_colour),
plot.subtitle = element_markdown(family = title_family,
size = 40, colour = text_colour),
plot.caption = element_text(family = title_family,
size = 25, colour = text_colour, hjust = 0),
panel.background = element_rect(fill = background, color = NA),
panel.border = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
plot.margin = unit(c(3, 0.5, 0.5, 0.5), "cm"), # top, left, bottom, right
axis.title.y = element_text(face = 'bold', size = 40,
colour = text_colour),
axis.title.x = element_blank(),
axis.text.x.bottom = element_text(size = 45, colour= axis_colour,
vjust = 17),
axis.text.x.top = element_text(size = 45, colour= axis_colour,
vjust = -14),
axis.text.y = element_text(size = 30, colour = text_colour),
axis.ticks = element_blank(),
axis.line = element_blank(),
legend.text = element_text(size = 20, colour= text_colour),
legend.title = element_text(size = 25, colour= text_colour),
legend.position="none")
theme_set(theme_classic() + theme_style)
#Set colour palette
cols <- c("#F2D9F3", "#F2D9F3", "#00E5E5", "#DEB887",
"#FAC8C8", "#39393A", "#FA9664",
"#FF4040", "#48DE7A", "#942DC7",
"#F5F5DC", "#FAFA00")
figure <- pdf5 %>%
ggplot(aes(x = year, y = rank, group = word)) +
geom_line(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 4) +
geom_point(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 10) +
geom_line(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 4) +
geom_point(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 10) +
scale_y_reverse(breaks = 100:1, sec.axis = dup_axis()) +
scale_x_continuous(breaks = seq(2001, 2020, 2), limits= c(1999.8, 2021.2),
expand = c(.05, .05), sec.axis = dup_axis()) +
geom_text(data = pdf5 %>% filter(year == "2001"),
aes(label = word, x = 2000.8, color = variable_col),
hjust = "right",
fontface = "bold",
size = 11) +
geom_text(data = pdf5 %>%  filter(year == "2020"),
aes(label = word, x = 2020.2, color = variable_col),
hjust = "left",
fontface = "bold",
size = 11) +
coord_cartesian(ylim = c(101,1)) +
scale_color_manual(values = cols) +
labs(title = "<b style='color:red;'>NCWSS</b> annual meeting
proceedinds text analysis from 2001 through 2020",
subtitle = "Figure shows the rank of top 100 words of 2001 (left)
and 2020 (right) <b style='color:red;'>NCWSS</b> annual meeting proceedings.
Common weed species names are highlighed \n to describe
their change across 20 years.",
y= "Rank",
caption = "Visualization: @maxwelco adapted from @JaredBraggins | Source: NCWSS")
#Export plot
ggsave("top_weeds.png", width = 40, height = 60, dpi=400, limitsize = FALSE, figure)
#Set theme
library(extrafont)
extrafont::loadfonts()
font_family <- 'Helvetica'
title_family <- ".New York"
background <- "#1D1D1D"
text_colour <- "white"
axis_colour <- "white"
plot_colour <- "black"
theme_style <- theme(text = element_text(family = font_family),
rect = element_rect(fill = background),
plot.background = element_rect(fill = background, color = NA),
plot.title = element_markdown(family = title_family,
face = 'bold', size = 80, colour = text_colour),
plot.subtitle = element_markdown(family = title_family,
size = 40, colour = text_colour),
plot.caption = element_markdown(family = title_family,
size = 25, colour = text_colour, hjust = 0),
panel.background = element_rect(fill = background, color = NA),
panel.border = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
plot.margin = unit(c(3, 0.5, 0.5, 0.5), "cm"), # top, left, bottom, right
axis.title.y = element_text(face = 'bold', size = 40,
colour = text_colour),
axis.title.x = element_blank(),
axis.text.x.bottom = element_text(size = 45, colour= axis_colour,
vjust = 17),
axis.text.x.top = element_text(size = 45, colour= axis_colour,
vjust = -14),
axis.text.y = element_text(size = 30, colour = text_colour),
axis.ticks = element_blank(),
axis.line = element_blank(),
legend.text = element_text(size = 20, colour= text_colour),
legend.title = element_text(size = 25, colour= text_colour),
legend.position="none")
theme_set(theme_classic() + theme_style)
#Set colour palette
cols <- c("#F2D9F3", "#F2D9F3", "#00E5E5", "#DEB887",
"#FAC8C8", "#39393A", "#FA9664",
"#FF4040", "#48DE7A", "#942DC7",
"#F5F5DC", "#FAFA00")
figure <- pdf5 %>%
ggplot(aes(x = year, y = rank, group = word)) +
geom_line(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 4) +
geom_point(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 10) +
geom_line(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 4) +
geom_point(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 10) +
scale_y_reverse(breaks = 100:1, sec.axis = dup_axis()) +
scale_x_continuous(breaks = seq(2001, 2020, 2), limits= c(1999.8, 2021.2),
expand = c(.05, .05), sec.axis = dup_axis()) +
geom_text(data = pdf5 %>% filter(year == "2001"),
aes(label = word, x = 2000.8, color = variable_col),
hjust = "right",
fontface = "bold",
size = 11) +
geom_text(data = pdf5 %>%  filter(year == "2020"),
aes(label = word, x = 2020.2, color = variable_col),
hjust = "left",
fontface = "bold",
size = 11) +
coord_cartesian(ylim = c(101,1)) +
scale_color_manual(values = cols) +
labs(title = "<b style='color:red;'>NCWSS</b> annual meeting
proceedinds text analysis from 2001 through 2020",
subtitle = "Figure shows the rank of top 100 words of 2001 (left)
and 2020 (right) <b style='color:red;'>NCWSS</b> annual meeting proceedings.
Common weed species names are highlighed <br> to describe
their change across 20 years.",
y= "Rank",
caption = "Visualization: @maxwelco adapted from @JaredBraggins | Source: NCWSS")
#Export plot
ggsave("top_weeds.png", width = 40, height = 60, dpi=400, limitsize = FALSE, figure)
figure <- pdf5 %>%
ggplot(aes(x = year, y = rank, group = word)) +
geom_line(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 4) +
geom_point(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 10) +
geom_line(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 4) +
geom_point(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 10) +
scale_y_reverse(breaks = 100:1, sec.axis = dup_axis()) +
scale_x_continuous(breaks = seq(2001, 2020, 2), limits= c(1999.8, 2021.2),
expand = c(.05, .05), sec.axis = dup_axis()) +
geom_text(data = pdf5 %>% filter(year == "2001"),
aes(label = word, x = 2000.8, color = variable_col),
hjust = "right",
fontface = "bold",
size = 11) +
geom_text(data = pdf5 %>%  filter(year == "2020"),
aes(label = word, x = 2020.2, color = variable_col),
hjust = "left",
fontface = "bold",
size = 11) +
coord_cartesian(ylim = c(101,1)) +
scale_color_manual(values = cols) +
labs(title = "<b style='color:red;'>NCWSS</b> annual meeting
proceedinds text analysis from 2001 through 2020",
subtitle = "Figure shows the rank of top 100 words of 2001 (left)
and 2020 (right) <b style='color:red;'>NCWSS</b> annual meeting proceedings.
Common weed species names are highlighed to <br> describe
their change across 20 years.",
y= "Rank",
caption = "Visualization: @maxwelco adapted from @JaredBraggins | Source: NCWSS")
#Export plot
ggsave("top_weeds.png", width = 40, height = 60, dpi=400, limitsize = FALSE, figure)
blogdown:::serve_site()
blogdown::stop_server()
blogdown:::serve_site()
blogdown::stop_server()
blogdown:::serve_site()
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(tidytext)
library(textreadr)
library(pdftools)
library(ggtext)
# if you do not have any of these packages installed, please run install.packages("name_of_the_package")
pdfs <- str_c("docs", "/", list.files("docs", pattern = "*.pdf"),
sep = "")
pdfs
pdf_names <- list.files("docs", pattern = "*.pdf")
pdf_names
pdfs_text <- map(pdfs, pdftools::pdf_text)
pdf <- tibble(document = pdf_names, text = pdfs_text) %>%
mutate(year = 2001:2020) # adding a column for each year
pdf
pdf1 <- pdf %>%
unnest(text) %>% # pdfs_text is a list
mutate(text = str_to_lower(text), # making all text lower case
text = str_replace(text, "2,4-d",
"twofourd"), # need to replace it
text = str_replace(text, "marestail",
"horseweed")) %>% # marestail = horseweed
unnest_tokens(word, text, strip_numeric = TRUE)
pdf1 %>%
slice_head(n = 10)
stopwords <- get_stopwords("en", source = c("smart")) %>%
bind_rows(get_stopwords("en", source = c("marimo"))) %>%
bind_rows(get_stopwords("en", source = c("nltk"))) %>%
bind_rows(get_stopwords("en", source = c("stopwords-iso"))) %>%
bind_rows(get_stopwords("en", source = c("snowball")))
stopwords %>%
slice_head(n=10)
pdf2 <- pdf1 %>%
anti_join(stopwords, by = "word")
source("stop_words.R")
pdf3 <- pdf2 %>%
anti_join(stop_tibble, by = c("word")) %>% # stop_tibble is in the source code
mutate(word = str_replace(word, "twofourd", "2,4-d")) # bring back 2,4-d
pdf4 <- pdf3 %>%
count(year, word) %>%
arrange(year, -n) %>%
group_by(year) %>%
mutate(rank = row_number()) %>%
filter(rank <= 100)
pdf4 %>%
slice_head(n = 10)
pdf5 <- pdf4 %>%
mutate(highlight = if_else(word %in% c("amaranth", "palmer",
"kochia", "horseweed",
"grass", "nightshade",
"waterhemp", "velvetleaf",
"ragweed", "sunflower",
"foxtail"), TRUE, FALSE),
variable_col = if_else(highlight == TRUE, word, "NA"))
pdf5 %>%
slice_head(n = 5)
#Set theme
library(extrafont)
extrafont::loadfonts()
font_family <- 'Helvetica'
title_family <- ".New York"
background <- "#1D1D1D"
text_colour <- "white"
axis_colour <- "white"
plot_colour <- "black"
theme_style <- theme(text = element_text(family = font_family),
rect = element_rect(fill = background),
plot.background = element_rect(fill = background, color = NA),
plot.title = element_markdown(family = title_family,
face = 'bold', size = 80, colour = text_colour),
plot.subtitle = element_markdown(family = title_family,
size = 40, colour = text_colour),
plot.caption = element_markdown(family = title_family,
size = 25, colour = text_colour, hjust = 0),
panel.background = element_rect(fill = background, color = NA),
panel.border = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
plot.margin = unit(c(3, 0.5, 0.5, 0.5), "cm"), # top, left, bottom, right
axis.title.y = element_text(face = 'bold', size = 40,
colour = text_colour),
axis.title.x = element_blank(),
axis.text.x.bottom = element_text(size = 45, colour= axis_colour,
vjust = 17),
axis.text.x.top = element_text(size = 45, colour= axis_colour,
vjust = -14),
axis.text.y = element_text(size = 30, colour = text_colour),
axis.ticks = element_blank(),
axis.line = element_blank(),
legend.text = element_text(size = 20, colour= text_colour),
legend.title = element_text(size = 25, colour= text_colour),
legend.position="none")
theme_set(theme_classic() + theme_style)
#Set colour palette
cols <- c("#F2D9F3", "#F2D9F3", "#00E5E5", "#DEB887",
"#FAC8C8", "#39393A", "#FA9664",
"#FF4040", "#48DE7A", "#942DC7",
"#F5F5DC", "#FAFA00")
figure <- pdf5 %>%
ggplot(aes(x = year, y = rank, group = word)) +
geom_line(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 4) +
geom_point(data = pdf5 %>% filter(variable_col == "NA"),
color = "#39393A", size = 10) +
geom_line(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 4) +
geom_point(data = pdf5 %>% filter(variable_col != "NA"),
aes(color = variable_col), size = 10) +
scale_y_reverse(breaks = 100:1, sec.axis = dup_axis()) +
scale_x_continuous(breaks = seq(2001, 2020, 2), limits= c(1999.8, 2021.2),
expand = c(.05, .05), sec.axis = dup_axis()) +
geom_text(data = pdf5 %>% filter(year == "2001"),
aes(label = word, x = 2000.8, color = variable_col),
hjust = "right",
fontface = "bold",
size = 11) +
geom_text(data = pdf5 %>%  filter(year == "2020"),
aes(label = word, x = 2020.2, color = variable_col),
hjust = "left",
fontface = "bold",
size = 11) +
coord_cartesian(ylim = c(101,1)) +
scale_color_manual(values = cols) +
labs(title = "<b style='color:red;'>NCWSS</b> annual meeting
proceedinds text analysis from 2001 through 2020",
subtitle = "Figure shows the rank of top 100 words of 2001 (left)
and 2020 (right) <b style='color:red;'>NCWSS</b> annual meeting proceedings.
Common weed species names are highlighed to <br> describe
their change across 20 years.",
y= "Rank",
caption = "Visualization: @maxwelco adapted from @JaredBraggins | Source: NCWSS")
#Export plot
ggsave("top_weeds.png", width = 40, height = 60, dpi=400, limitsize = FALSE, figure)
blogdown:::serve_site()
library(tidyverse)
library(glmmTMB)
library(lme4)
library(lmerTest)
library(emmeans)
library(RCurl)
library(kableExtra)
library(car)
df_path <- getURL("https://raw.githubusercontent.com/openweedsci/data/master/posts/control.csv")
weedcont <- read_csv(df_path)
model <- glmmTMB(control ~ herbicide + (1|rep), beta_family(link = "logit"), data=weedcont)
glmmTMB:::Anova.glmmTMB(model)
emmip(model, ~herbicide, type="response")
lsmeans <- emmeans(model, ~ herbicide, cont="pairwise", adjust="none", type="response", alpha=0.05)
lsmeans
plot(lsmeans, ~ herbicide, comparisons=TRUE, type="response", alpha=0.05, adjust="none")
cld <-CLD(lsmeans$emmeans, alpha=0.05, Letters=letters, adjust="none", reversed = TRUE)
library(multcomp)
cld <- cld(lsmeans$emmeans, alpha=0.05, Letters=letters, adjust="none", reversed = TRUE)
cld
nd <- as.data.frame(lsmeans$emmeans)
ggplot(nd, aes(x=reorder(herbicide,response), y=response*100, color=herbicide)) +
geom_point(size=4) + ylim(0,100) +
scale_color_manual(values=c("red", "blue", "green", "orange", "purple")) +
theme_bw() + labs(y="Waterhemp control (%)", x="Herbicides") +
geom_linerange(aes(ymin = lower.CL*100, ymax = upper.CL*100), size=1.5) +
theme(axis.title = element_text(size=16),
axis.text = element_text(size=15),
legend.position = "none") +
coord_flip()
ggplot(cld, aes(x=reorder(herbicide,response),
y=response*100, fill=herbicide, label=.group)) +
geom_bar(stat="identity") + ylim(0,105) +
scale_fill_manual(values=c("red", "blue", "green", "orange", "purple")) +
theme_bw() +  labs(y="Waterhemp control (%)", x="Herbicides") +
geom_text(nudge_y = 7, size=8) +
theme(axis.title = element_text(size=16),
axis.text = element_text(size=15),
legend.position = "none") +
coord_flip()
cld %>%
kbl() %>%
kable_classic_2(full_width = F)
