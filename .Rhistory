blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
library(tidyverse)
library(glmmTMB)
library(lme4)
library(lmerTest)
library(emmeans)
library(RCurl)
library(kableExtra)
library(car)
df_path <- getURL("https://raw.githubusercontent.com/openweedsci/data/master/posts/control.csv")
weedcont <- read_csv(df_path)
weedcont
leveneTest(weedcont$control,  weedcont$herbicide)
model <- glmmTMB(control ~ herbicide + (1|rep), beta_family(link = "logit"), data=weedcont)
glmmTMB:::Anova.glmmTMB(model)
emmip(model, ~herbicide, type="response")
lsmeans <- emmeans(model, ~ herbicide, cont="pairwise", adjust="none", type="response", alpha=0.05)
lsmeans
plot(lsmeans, ~ herbicide, comparisons=TRUE, type="response", alpha=0.05, adjust="none")
nd <- as.data.frame(lsmeans$emmeans)
ggplot(nd, aes(x=reorder(herbicide,response), y=response*100, color=herbicide)) +
geom_point(size=4) + ylim(0,100) +
scale_color_manual(values=c("red", "blue", "green", "orange", "purple")) +
theme_bw() + labs(y="Waterhemp control (%)", x="Herbicides") +
geom_linerange(aes(ymin = lower.CL*100, ymax = upper.CL*100), size=1.5) +
theme(axis.title = element_text(size=16),
axis.text = element_text(size=15),
legend.position = "none") +
coord_flip()
ggplot(cld, aes(x=herbicide, y=response*100, fill=herbicide, label=.group)) +
geom_bar(stat="identity") + ylim(0,105) +
scale_fill_manual(values=c("red", "blue", "green", "orange", "purple")) +
theme_bw() +  labs(y="Waterhemp control (%)", x="Herbicides") +
geom_text(nudge_y = 7, size=8) +
theme(axis.title = element_text(size=16),
axis.text = element_text(size=15),
legend.position = "none")
cld <-CLD(lsmeans$emmeans, alpha=0.05, Letters=letters, adjust="none", reversed = TRUE)
cld
cld <-CLD(lsmeans$emmeans, alpha=0.05, Letters=letters, adjust="none", reversed = TRUE)
cld
ggplot(cld, aes(x=herbicide, y=response*100, fill=herbicide, label=.group)) +
geom_bar(stat="identity") + ylim(0,105) +
scale_fill_manual(values=c("red", "blue", "green", "orange", "purple")) +
theme_bw() +  labs(y="Waterhemp control (%)", x="Herbicides") +
geom_text(nudge_y = 7, size=8) +
theme(axis.title = element_text(size=16),
axis.text = element_text(size=15),
legend.position = "none")
kable(nd)
kable(cld)
kable(cld) %>%
kbl() %>%
kable_classic_2(full_width = F)
library(tidyverse)
library(glmmTMB)
library(lme4)
library(lmerTest)
library(emmeans)
library(RCurl)
library(kableExtra)
library(car)
kable(cld) %>%
kbl() %>%
kable_classic_2(full_width = F)
cld %>%
kbl() %>%
kable_classic_2(full_width = F)
df_path <- getURL("https://raw.githubusercontent.com/maxwelco/General_codes/master/anova-beta/data/control.csv")
dado <- read_csv(df_path)
dado
leveneTest(dado$control,  dado$herbicide)
model <- glmmTMB(control ~ herbicide + (1|year/rep), beta_family(link = "logit"), data=dado)
glmmTMB:::Anova.glmmTMB(model)
emmip(model, ~herbicide, type="response") + coord_flip()
lsmeans <- emmeans(model, ~ herbicide, cont="pairwise", adjust="none", type="response", alpha=0.05)
lsmeans
plot(lsmeans, ~ herbicide, comparisons =TRUE, type="response", alpha=0.05, adjust="none")
nd <- as.data.frame(lsmeans$emmeans)
ggplot(nd, aes(x=reorder(herbicide,response), y=response*100, color=herbicide)) +
geom_point(size=4) + ylim(0,100) + coord_flip() +
scale_color_manual(values=c("red", "blue", "green", "orange", "purple")) +
theme_bw() +  labs(y="Controle de caruru (%)", x="Herbicidas") +
geom_linerange(aes(ymin  =  lower.CL*100, ymax  =  upper.CL*100), size=1.5) +
theme(axis.title = element_text(size=16),
axis.text = element_text(size=15),
legend.position = "none")
cld <-CLD(lsmeans, alpha=0.05, Letters=letters, adjust="none", reversed = TRUE)
cld <-CLD(lsmeans$emmeans, alpha=0.05, Letters=letters, adjust="none", reversed = TRUE)
cld
ggplot(cld, aes(x=herbicide, y=response*100, fill=herbicide, label=.group)) +
geom_bar(stat="identity") + ylim(0,105) +
scale_fill_manual(values=c("red", "blue", "green", "orange", "purple")) +
theme_bw() +  labs(y="Waterhemp control (%)", x="Herbicides") +
geom_text(nudge_y = 7, size=8) +
theme(axis.title = element_text(size=16),
axis.text = element_text(size=15),
legend.position = "none")
cld %>%
kbl() %>%
kable_classic_2(full_width = F)
blogdown:::serve_site()
ggplot(cld, aes(x=reorder(herbicide,response), y=response*100, fill=herbicide, label=.group)) +
geom_bar(stat="identity") + ylim(0,105) +
scale_fill_manual(values=c("red", "blue", "green", "orange", "purple")) +
theme_bw() +  labs(y="Waterhemp control (%)", x="Herbicides") +
geom_text(nudge_y = 7, size=8) +
theme(axis.title = element_text(size=16),
axis.text = element_text(size=15),
legend.position = "none")
ggplot(cld, aes(x=reorder(herbicide,response), y=response*100, fill=herbicide, label=.group)) +
geom_bar(stat="identity") + ylim(0,105) +
scale_fill_manual(values=c("red", "blue", "green", "orange", "purple")) +
theme_bw() +  labs(y="Waterhemp control (%)", x="Herbicides") +
geom_text(nudge_y = 7, size=8) +
theme(axis.title = element_text(size=16),
axis.text = element_text(size=15),
legend.position = "none")
ggplot(cld, aes(x=reorder(herbicide,response), y=response*100, fill=herbicide, label=.group)) +
geom_bar(stat="identity") + ylim(0,105) +
scale_fill_manual(values=c("red", "blue", "green", "orange", "purple")) +
theme_bw() +  labs(y="Waterhemp control (%)", x="Herbicides") +
geom_text(nudge_y = 7, size=8) +
theme(axis.title = element_text(size=16),
axis.text = element_text(size=15),
legend.position = "none")
blogdown:::serve_site()
